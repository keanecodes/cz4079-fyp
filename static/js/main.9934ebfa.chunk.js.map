{"version":3,"sources":["data/recoil.js","layouts/common/Map.js","layouts/mobile/FilterPills.js","components/Radio.js","components/CheckBox.js","layouts/desktop/LayersPopper.js","layouts/desktop/FilterBar.js","components/Slider.js","layouts/desktop/Timeline.js","layouts/mobile/TabBar.js","components/TabDrawer.js","layouts/desktop/DrawerDataPoint.js","layouts/desktop/DrawerStatistics.js","pages/App.js","components/BackDrop.js","pages/InitApp.js","index.js"],"names":["DEFAULT_LAYER","mapOriginalData","atom","key","default","mapData","borderData","filterAttributes","room","resale_price","Infinity","flat_model","selectedArea","modalControls","attributes","checkbox","layers","radio","layerSelection","overlaySelection","selectedGeojsonArea","UIdrawerStatOpen","UIdrawerDataPointOpen","UILoading","UITxtLoading","INITIAL_VIEW_STATE","latitude","longitude","zoom","pitch","bearing","getTooltip","object","date","Date","timestamp","toString","replace","floor_area_sqm","getUTCFullYear","getUTCMonth","dataFilter","DataFilterExtension","filterSize","fp64","Map","filterValue","mapStyle","MAP_STYLE","setLoading","useSetRecoilState","setTxtLoading","loaded","setLoaded","useState","glContext","setGLContext","deckRef","useRef","mapRef","originalData","useRecoilValue","filters","updateFilter","useRecoilState","data","setFilter","border","layerSel","overlaySel","prevLayer","setPrevLayer","setSelectedArea","openStatDrawer","onMapLoad","useCallback","map","current","getMap","deck","addLayer","MapboxLayer","id","commonAttributes","radiusMinPixels","getPosition","d","getRadius","timelineAttributes","opacity","getFilterValue","filterRange","filterSoftRange","extensions","layerAttributes","radiusPixels","getWeight","radiusScale","wrapLongitude","getFillColor","r","Math","sqrt","max","pickable","extruded","elevationScale","radius","coverage","lowerPercentile","getElevationWeight","elevationAggregation","transitions","ScatterplotLayer","HeatmapLayer","HexagonLayer","length","includes","GeoJsonLayer","stroked","filled","lineWidthMinPixels","f","properties","OBJECTID","updateTriggers","getLineColor","autoHighlight","highlightColor","onClick","e","PLN_AREA_N","getLayer","removeLayer","React","useEffect","filter","Boolean","ref","onWebGLInitialized","initialViewState","controller","glOptions","stencil","gl","preventStyleDiffing","attributionControl","mapboxApiAccessToken","process","onLoad","FilterPills","classes","useStyles","className","root","pill","makeStyles","width","display","padding","backgroundColor","position","flex","borderRadius","height","margin","icon","boxShadow","backgroundImage","outline","outlineOffset","background","checkedIcon","content","RadioButton","props","Radio","disableRipple","color","clsx","CheckBox","Checkbox","inputProps","LayersPopper","open","setOpen","anchorRef","handleClose","event","contains","target","prevOpen","focus","controls","setControls","layer","setLayer","overlay","setOverlay","handleLayer","value","handleChange","group","type","name","checked","olyrs","push","fOLyrs","val","IconButton","aria-controls","undefined","aria-haspopup","variant","size","Popper","paper","anchorEl","role","transition","disablePortal","Paper","ClickAwayListener","onClickAway","MenuList","autoFocusItem","onKeyDown","preventDefault","RadioGroup","Object","keys","lbl","MenuItem","ListItemIcon","FormControlLabel","onChange","control","label","FormGroup","zIndex","paddingRight","textAlign","fontSize","cursor","FilterBar","filterBarRoot","logo","FilterOption","setFilters","updateHandler","split","filterOptionRoot","gridTemplateColumns","flexDirection","borderTop","fontWeight","letterSpacing","marginTop","borderStyle","outlineColor","iOSBoxShadow","IOSSlider","withStyles","marginLeft","thumb","active","valueLabel","left","top","track","rail","mark","markActive","Slider","Timeline","min","isPlaying","setIsPlaying","animation","cancelAnimationFrame","span","nextValueMin","MS_PER_DAY","requestAnimationFrame","isButtonEnabled","disabled","title","getAriaValueText","valuetext","aria-labelledby","timeline","newValue","valueLabelDisplay","valueLabelFormat","formatLabel","overflow","overflowY","t","TabBar","item","pull","alignItems","justifyContent","bottom","TabDrawer","state","anchor","triggerTagLocation","triggerName","triggerHeight","triggerWidth","styleSeparator","styleTrigger","children","layerSelected","fullHeight","drawer","flexShrink","drawerPaper","drawerContainer","separator","drawerTrigger","transformOrigin","transform","right","userSelect","visibility","Drawer","DrawerDataPoint","style","trigger","SortBar","dataCardContainer","slice","i","DataCard","dataCard","address","lRemain","sortBar","arrow","fontSpacing","paddingBottom","marginBottom","verticalAlign","lineHeight","marginRight","fontStyle","DrawerStatistics","count","Array","growth","_","range","y","town","getFullYear","dashboardActiveCountriesCard","canvas","ctx","getContext","gradientStroke","createLinearGradient","addColorStop","chartColor","gradientFill","hexToRGB","labels","datasets","borderColor","pointBorderColor","pointBackgroundColor","pointBorderWidth","pointHoverRadius","pointHoverBorderWidth","pointRadius","fill","borderWidth","values","options","gradientChartOptionsConfiguration","statDrawerContainer","areaTitle","detailsContainer","REGION_N","parseInt","SHAPE_Area","toFixed","graphContainer","lineChartContainer","entries","c","lineChartCont","lineChart","hex","alpha","g","b","maintainAspectRatio","legend","tooltips","bodySpacing","mode","intersect","xPadding","yPadding","caretPadding","responsive","scales","yAxes","ticks","maxTicksLimit","gridLines","zeroLineColor","drawTicks","drawBorder","xAxes","layout","App","isMobile","useMediaQuery","maxWidth","orientation","modal","timeRange","useMemo","reduce","getTimeRange","theme","backdrop","BackDrop","txtLoading","Backdrop","InitApp","loading","setOriginal","setMapData","setBorder","d3","then","res","row","String","block","street_name","flat_type","remaining_lease","month","getTime","Number","hist","createBrowserHistory","render","history","path","to","document","getElementById"],"mappings":"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","file":"static/js/main.9934ebfa.chunk.js","sourcesContent":["import { atom } from 'recoil'\n\nexport const DEFAULT_LAYER = 'scatter'\n\nexport const mapOriginalData = atom({\n  key: 'mapOriginalData',\n  default: null\n})\n\nexport const mapData = atom({\n  key: 'mapData',\n  default: null\n})\n\nexport const borderData = atom({\n  key: 'borderData',\n  default: null\n})\n\nexport const filterAttributes = atom({\n  key: 'filterAttributes',\n  default: {\n    room: [''],\n    resale_price: [0,Infinity],\n    flat_model: [''],\n    selectedArea: [''],\n  }\n\n})\n\nexport const modalControls = atom({\n  key: 'modalControls',\n  default: {\n    attributes: {\n      checkbox: {\n        'Amenities': true,\n        'MRT': false,\n        'Schools': false,\n        'Parks': false,\n        // 'Race Ratio': false,\n        // 'Gender Ratio': false,\n        // 'Population Density': false,\n      }\n    }, \n    layers: {\n      radio: {\n        'Scatter Layer (2D Only)': DEFAULT_LAYER,\n        'Heat Map (2D Only)': 'heat',\n        'Hexagon Layer (3D Only)': 'hex',\n      },\n      checkbox: {\n        'Region Border Layer (2D Only)': false,\n      }\n    }\n  }\n})\n\nexport const layerSelection = atom({\n  key: 'layerSelection',\n  default: DEFAULT_LAYER\n})\n\nexport const overlaySelection = atom({\n  key: 'overlaySelection',\n  default: []\n})\n\nexport const selectedGeojsonArea = atom({\n  key: 'selectedGeojsonArea',\n  default: null\n})\n\nexport const UIdrawerStatOpen = atom({\n  key: 'UIdrawerStatOpen',\n  default: false\n})\n\nexport const UIdrawerDataPointOpen = atom({\n  key: 'UIdrawerDataPointOpen',\n  default: false\n})\n\nexport const UILoading = atom({\n  key: 'UILoading',\n  default: true\n})\n\nexport const UITxtLoading = atom({\n  key: 'UITxtLoading',\n  default: \"Loading 100,000 Data Points...\"\n})","import React, { useRef, useState, useCallback } from \"react\";\nimport DeckGL from '@deck.gl/react';\nimport { StaticMap } from 'react-map-gl';\nimport { DataFilterExtension } from '@deck.gl/extensions';\nimport { ScatterplotLayer, GeoJsonLayer } from '@deck.gl/layers';\nimport { HeatmapLayer, HexagonLayer } from '@deck.gl/aggregation-layers';\nimport { MapboxLayer } from \"@deck.gl/mapbox\";\nimport \"mapbox-gl/dist/mapbox-gl.css\";\nimport MAP_STYLE from \"positron.json\";\nimport { useRecoilValue, useSetRecoilState, useRecoilState } from 'recoil'\nimport { \n  mapOriginalData, \n  mapData,\n  filterAttributes,\n  borderData,\n  DEFAULT_LAYER,\n  layerSelection, \n  overlaySelection, \n  selectedGeojsonArea,\n  UIdrawerStatOpen,\n  UILoading,\n  UITxtLoading,\n} from 'data/recoil'\n\nconst INITIAL_VIEW_STATE = {\n  latitude: 1.3451,\n  longitude: 103.8198,\n  zoom: 11,\n  pitch: 40,\n  bearing: -10\n};\n\nfunction getTooltip({object}) {\n  const date = new Date(object?.timestamp);\n  return (\n    object?.resale_price &&\n    `\\\n    Resale price: S$${object?.resale_price?.toString().replace(/\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))/g, \",\")}\n    Floor area: ${object?.floor_area_sqm} sqm\n    Transacted on: ${date?.getUTCFullYear()}-${date?.getUTCMonth() + 1}\n    `\n  );\n}\n\nconst dataFilter = new DataFilterExtension({\n  filterSize: 1,\n  fp64: false\n})\n\nexport default function Map({filterValue, mapStyle = MAP_STYLE}) {\n  const setLoading = useSetRecoilState(UILoading)\n  const setTxtLoading = useSetRecoilState(UITxtLoading)\n  setTxtLoading(\"85%\")\n  const [loaded, setLoaded] = useState(false)\n  const [glContext, setGLContext] = useState();\n  const deckRef = useRef(null);\n  const mapRef = useRef(null);\n  const originalData = useRecoilValue(mapOriginalData)\n  const [filters, updateFilter] = useRecoilState(filterAttributes)\n  const [data, setFilter] = useRecoilState(mapData)\n  const border = useRecoilValue(borderData)\n  const layerSel = useRecoilValue(layerSelection)\n  const overlaySel = useRecoilValue(overlaySelection)\n  const [prevLayer, setPrevLayer] = useState(DEFAULT_LAYER)\n  const [selectedArea, setSelectedArea] = useRecoilState(selectedGeojsonArea)\n  const openStatDrawer = useSetRecoilState(UIdrawerStatOpen)\n\n  const onMapLoad = useCallback(() => {\n    const map = mapRef.current.getMap();\n    const deck = deckRef.current.deck;\n    setLoading(false)\n    setTxtLoading(\"\")\n    setLoaded(true)\n    \n    //! Initialize an empty deck.gl layer to prevent flashing\n    map.addLayer(\n      new MapboxLayer({ id: `resaletimeline${prevLayer}`, deck }), // This id has to match the id of the deck.gl layer\n      'place_suburbs' // Optionally define id from Mapbox layer stack under which to add deck layer\n    );\n    // eslint-disable-next-line\n  }, [layerSel, setLoading, setTxtLoading]);\n\n  const commonAttributes = {\n    id: `resaletimeline${layerSel}`,\n    data,\n    radiusMinPixels: 1,\n    getPosition: d => [d.longitude, d.latitude], // getPosition: d => [d.longitude, d.latitude, -d.depth * 1000],\n    getRadius: d => d.floor_area_sqm, // getRadius: d => Math.pow(2, d.floor_area_sqm),\n  }\n\n  const timelineAttributes = {\n    opacity: 0.3,\n    getFilterValue: d => d.timestamp,\n    filterRange: [filterValue[0], filterValue[1]],\n    filterSoftRange: [\n      filterValue[0] * 0.9 + filterValue[1] * 0.1,\n      filterValue[0] * 0.1 + filterValue[1] * 0.9\n    ],\n    extensions: [dataFilter],\n  }\n\n  let layerAttributes = null\n\n  switch (layerSel) {\n    case 'heat':\n      layerAttributes = {\n        radiusPixels: 60,\n        getWeight: d => d.resale_price,\n        ...commonAttributes,\n        ...timelineAttributes,\n      }\n      break;\n    case 'scatter':\n      layerAttributes = {\n        radiusScale: 0.6,\n        wrapLongitude: true,\n        getFillColor: d => {\n          const r = Math.sqrt(Math.max(d.resale_price, 0));\n          return [255 - r * 0.3, r * 0.18, r * 0.8]; // return [255, 0, 0];\n        },\n        pickable: true,\n        ...commonAttributes,\n        ...timelineAttributes,\n      }\n      break;\n    case 'hex': \n      layerAttributes = {\n        extruded: true,\n        elevationScale: 10,\n        opacity: 0.8,\n        radius: 509,\n        coverage: 0.88,\n        lowerPercentile: 50,\n        getElevationWeight: d => d.resale_price,\n        elevationAggregation: 'MAX',\n        transitions: {\n          elevationScale: 1000\n        },\n        ...commonAttributes,\n      }\n      break;\n    default: break;\n  }\n\n  setTxtLoading(\"80%\")\n\n  const layers = glContext ? [\n    data && \n      layerSel === 'scatter' \n      ? new ScatterplotLayer(layerAttributes) \n      : layerSel === 'heat' \n      ? new HeatmapLayer(layerAttributes)\n      : new HexagonLayer(layerAttributes),\n    border && overlaySel.length > 0 &&\n      overlaySel[0].includes('Border') \n      ? new GeoJsonLayer({\n        id: 'geojson',\n        data: border,\n        opacity: 0.8,\n        stroked: true,\n        filled: true,\n        lineWidthMinPixels: 3,\n        extruded: false,\n        getFillColor: f => {\n          if (selectedArea && f.properties.OBJECTID === selectedArea.OBJECTID) return [25,116,210, 255]\n          return [212,218,220,255]\n        },\n        updateTriggers: {\n          getFillColor: [selectedArea ? selectedArea.OBJECTID : null]\n        },\n        getLineColor: [29, 161, 242],\n        pickable: true,\n        autoHighlight: true,\n        highlightColor: [142,223,255],\n        onClick: (e) => { \n          setSelectedArea(e.object.properties)\n          updateFilter({...filters, selectedArea: [e.object.properties.PLN_AREA_N]})\n          openStatDrawer(true)\n          // console.log(e); return true; \n        }\n      }) : null\n  ] : [];\n\n  \n  if (loaded) {\n    const map = mapRef.current.getMap();\n    const deck = deckRef.current.deck;\n    if (layerSel !== prevLayer) {\n      if (map.getLayer(`resaletimeline${prevLayer}`)) map.removeLayer(`resaletimeline${prevLayer}`);\n      setPrevLayer(layerSel)\n      //! Initialize an empty deck.gl layer to prevent flashing\n      map.addLayer(\n        // border && overlaySel.length > 0 &&\n        // new MapboxLayer({ id: 'geojson', deck }), // This id has to match the id of the deck.gl layer\n        new MapboxLayer({ id: `resaletimeline${layerSel}`, deck }), // This id has to match the id of the deck.gl layer\n        'place_suburbs', // Optionally define id from Mapbox layer stack under which to add deck layer\n      );\n    }\n  }\n\n  React.useEffect(() => {\n    setFilter(\n      originalData\n      .filter(d => filters['room'][0] === \"\" ? Boolean : d['room'] === filters['room'][0])\n      .filter(d => filters['flat_model'][0] === \"\" ? Boolean : d['flat_model'] === filters['flat_model'][0])\n      .filter(d => filters['resale_price'][0] === 0 ? Boolean : d['resale_price'] >= filters['resale_price'][0] && d['resale_price'] <= filters['resale_price'][1])\n      .filter(d => filters['selectedArea'][0] === \"\" ? Boolean : d['town'] === filters['selectedArea'][0])\n    )\n    \n  // eslint-disable-next-line\n  },[filters, selectedArea])\n  \n\n  return (\n    <DeckGL\n      ref={deckRef}\n      onWebGLInitialized={setGLContext}\n      layers={layers}\n      initialViewState={INITIAL_VIEW_STATE}\n      controller={true}\n      pickable={true}\n      getTooltip={getTooltip}\n      glOptions={{ stencil: true }} /* To render vector tile polygons correctly */\n    >\n      {glContext && (\n        <StaticMap \n          ref={mapRef}\n          gl={glContext}\n          mapStyle={mapStyle} \n          preventStyleDiffing={true} \n          attributionControl={false}\n          mapboxApiAccessToken={process.env.REACT_APP_MAPBOX_ACCESS_TOKEN}\n          onLoad={onMapLoad}\n        />\n      )}\n    </DeckGL>\n);\n};\n","import React from 'react'\nimport { makeStyles } from '@material-ui/core/styles'\n\nexport default function FilterPills() {\n  const classes = useStyles();\n\n  return (\n    <div className={classes.root}>\n      <button className={classes.pill}>Property</button>\n      <button className={classes.pill}>Bedrooms</button>\n      <button className={classes.pill}>Price</button>\n      <button className={classes.pill}>MRT</button>\n      <button className={classes.pill}>Year</button>\n    </div>\n  )\n}\n\nconst useStyles = makeStyles(() => ({\n  root: {\n    width: '100%',\n    display: 'flex',\n    padding: '0.5rem',\n    backgroundColor: 'transparent',\n    position: 'absolute',\n  },\n  pill: {\n    flex: 1,\n    borderRadius: '25px',\n    border: 'none',\n    width: '1rem',\n    height: '3rem',\n    margin: '0.1rem',\n    backgroundColor: 'white',\n  }\n}));\n","import React from 'react';\nimport clsx from 'clsx';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Radio from '@material-ui/core/Radio';\n\nconst useStyles = makeStyles({\n  root: {\n    '&:hover': {\n      backgroundColor: 'transparent',\n    },\n  },\n  icon: {\n    borderRadius: '50%',\n    width: 16,\n    height: 16,\n    boxShadow: 'inset 0 0 0 1px rgba(16,22,26,.2), inset 0 -1px 0 rgba(16,22,26,.1)',\n    backgroundColor: '#f5f8fa',\n    backgroundImage: 'linear-gradient(180deg,hsla(0,0%,100%,.8),hsla(0,0%,100%,0))',\n    '$root.Mui-focusVisible &': {\n      outline: '2px auto rgba(19,124,189,.6)',\n      outlineOffset: 2,\n    },\n    'input:hover ~ &': {\n      backgroundColor: '#ebf1f5',\n    },\n    'input:disabled ~ &': {\n      boxShadow: 'none',\n      background: 'rgba(206,217,224,.5)',\n    },\n  },\n  checkedIcon: {\n    backgroundColor: '#137cbd',\n    backgroundImage: 'linear-gradient(180deg,hsla(0,0%,100%,.1),hsla(0,0%,100%,0))',\n    '&:before': {\n      display: 'block',\n      width: 16,\n      height: 16,\n      backgroundImage: 'radial-gradient(#fff,#fff 28%,transparent 32%)',\n      content: '\"\"',\n    },\n    'input:hover ~ &': {\n      backgroundColor: '#106ba3',\n    },\n  },\n});\n\n// Inspired by blueprintjs\nexport default function RadioButton(props) {\n  const classes = useStyles();\n\n  return (\n    <Radio\n      className={classes.root}\n      disableRipple\n      color=\"default\"\n      checkedIcon={<span className={clsx(classes.icon, classes.checkedIcon)} />}\n      icon={<span className={classes.icon} />}\n      {...props}\n    />\n  );\n}","import React from 'react';\nimport clsx from 'clsx';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Checkbox from '@material-ui/core/Checkbox';\n\n// Inspired by blueprintjs\nexport default function CheckBox(props) {\n  const classes = useStyles();\n\n  return (\n    <Checkbox\n      className={classes.root}\n      disableRipple\n      color=\"default\"\n      checkedIcon={<span className={clsx(classes.icon, classes.checkedIcon)} />}\n      icon={<span className={classes.icon} />}\n      inputProps={{ 'aria-label': 'decorative checkbox' }}\n      {...props}\n    />\n  );\n}\n\n\nconst useStyles = makeStyles({\n  root: {\n    '&:hover': {\n      backgroundColor: 'transparent',\n    },\n  },\n  icon: {\n    borderRadius: 3,\n    width: 16,\n    height: 16,\n    boxShadow: 'inset 0 0 0 1px rgba(16,22,26,.2), inset 0 -1px 0 rgba(16,22,26,.1)',\n    backgroundColor: '#f5f8fa',\n    backgroundImage: 'linear-gradient(180deg,hsla(0,0%,100%,.8),hsla(0,0%,100%,0))',\n    '$root.Mui-focusVisible &': {\n      outline: '2px auto rgba(19,124,189,.6)',\n      outlineOffset: 2,\n    },\n    'input:hover ~ &': {\n      backgroundColor: '#ebf1f5',\n    },\n    'input:disabled ~ &': {\n      boxShadow: 'none',\n      background: 'rgba(206,217,224,.5)',\n    },\n  },\n  checkedIcon: {\n    backgroundColor: '#137cbd',\n    backgroundImage: 'linear-gradient(180deg,hsla(0,0%,100%,.1),hsla(0,0%,100%,0))',\n    '&:before': {\n      display: 'block',\n      width: 16,\n      height: 16,\n      backgroundImage:\n        \"url(\\\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath\" +\n        \" fill-rule='evenodd' clip-rule='evenodd' d='M12 5c-.28 0-.53.11-.71.29L7 9.59l-2.29-2.3a1.003 \" +\n        \"1.003 0 00-1.42 1.42l3 3c.18.18.43.29.71.29s.53-.11.71-.29l5-5A1.003 1.003 0 0012 5z' fill='%23fff'/%3E%3C/svg%3E\\\")\",\n      content: '\"\"',\n    },\n    'input:hover ~ &': {\n      backgroundColor: '#106ba3',\n    },\n  },\n});","import React from 'react'\nimport IconButton from '@material-ui/core/IconButton';\nimport { FaLayerGroup } from \"react-icons/fa\"\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\nimport Paper from '@material-ui/core/Paper';\nimport Popper from '@material-ui/core/Popper';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport MenuList from '@material-ui/core/MenuList';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport RadioButton from 'components/Radio'\nimport CheckBox from 'components/CheckBox'\nimport RadioGroup from '@material-ui/core/RadioGroup';\nimport FormGroup from '@material-ui/core/FormGroup';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { useRecoilState, useSetRecoilState } from 'recoil'\nimport { \n  layerSelection, \n  modalControls,\n  overlaySelection\n} from 'data/recoil'\nimport { filterAttributes } from 'data/recoil';\nimport { selectedGeojsonArea } from 'data/recoil';\n\nexport default function LayersPopper() {\n  const classes = useStyles();\n  const [open, setOpen] = React.useState(false);\n  const anchorRef = React.useRef(null);\n\n  const handleToggle = () => {\n    setOpen((prevOpen) => !prevOpen);\n  };\n\n  const handleClose = (event) => {\n    if (anchorRef.current && anchorRef.current.contains(event.target)) {\n      return;\n    }\n\n    setOpen(false);\n  };\n\n  function handleListKeyDown(event) {\n    if (event.key === 'Tab') {\n      event.preventDefault();\n      setOpen(false);\n    }\n  }\n\n  // return focus to the button when we transitioned from !open -> open\n  const prevOpen = React.useRef(open);\n  React.useEffect(() => {\n    if (prevOpen.current === true && open === false) {\n      anchorRef.current.focus();\n    }\n\n    prevOpen.current = open;\n  }, [open]);\n\n  const [controls, setControls] = useRecoilState(modalControls)\n  const [layer, setLayer] = useRecoilState(layerSelection);\n  const [overlay, setOverlay] = useRecoilState(overlaySelection);\n  const setSelectedArea = useSetRecoilState(selectedGeojsonArea)\n  const [filters, updateFilter] = useRecoilState(filterAttributes)\n  \n  //handler for radio groups\n  const handleLayer = (e) => setLayer(e.target.value);\n\n  //handler for checkboxes\n  const handleChange = (e) => {\n    setControls({ \n      ...controls,\n      [group]: {\n        ...controls[group],\n        [e.target.type]: {\n          ...controls[group][e.target.type],\n          [e.target.name]: e.target.checked\n        }\n      }\n    });\n    if (group === 'layers') {\n      let olyrs = [...overlay]\n      //add checked layer\n      if (e.target.checked) {\n        olyrs.push(e.target.name)\n        setOverlay(olyrs)\n      } else { //remove checked layer\n        const fOLyrs = olyrs.filter(val => val !== e.target.name);\n        if (e.target.name.includes('Border')) {\n          setSelectedArea(null)\n          updateFilter({...filters, selectedArea: ['']})\n        }\n        setOverlay(fOLyrs)\n      }\n    }\n  };  \n\n  const group = 'layers'\n\n\n  return (\n    <div className={classes.root}>\n        <IconButton \n          ref={anchorRef}\n          aria-controls={open ? 'menu-list-grow' : undefined}\n          aria-haspopup=\"true\"\n          onClick={handleToggle}\n          variant=\"outlined\" \n          size=\"small\" \n          className={classes.icon}>\n          <FaLayerGroup/>\n        </IconButton>\n        <Popper className={classes.paper} open={open} anchorEl={anchorRef.current} role={undefined} transition disablePortal>\n          <Paper>\n            <ClickAwayListener onClickAway={handleClose}>\n              <MenuList autoFocusItem={open} id=\"menu-list-grow\" onKeyDown={handleListKeyDown}>\n                {controls[group].radio\n                ? <RadioGroup value={layer} name={group}> \n                    {Object.keys(controls[group].radio).map(lbl => {\n                      const val = controls[group].radio[lbl]\n                      return (\n                      <MenuItem key={`filter-modal-radio-${val}`} disableRipple>\n                        <ListItemIcon>\n                          <FormControlLabel \n                            value={val}\n                            onClick={handleClose}\n                            onChange={handleLayer}\n                            control={<RadioButton value={val} />}\n                            label={lbl}\n                          />\n                        </ListItemIcon>\n                      </MenuItem>)\n                    })}\n                  </RadioGroup>\n                  : null\n                }\n                {controls[group].checkbox\n                  ? <FormGroup>\n                      {Object.keys(controls[group].checkbox).map(lbl => \n                        <MenuItem key={`filter-modal-checkbox-${lbl}`} disableRipple>\n                          <ListItemIcon>\n                            <FormControlLabel\n                              control={<CheckBox checked={controls[group].checkbox[lbl]} onChange={handleChange} name={lbl} />}\n                              label={lbl}\n                            />\n                          </ListItemIcon>\n                        </MenuItem>\n                      )}\n                    </FormGroup>\n                  : null\n                }\n              </MenuList>\n            </ClickAwayListener>\n          </Paper>\n        </Popper>\n    </div>\n  )\n}\n\nconst useStyles = makeStyles(() => ({\n  paper: {\n    zIndex: 1\n  },\n  root: {\n    width: '2rem',\n    padding: '0.5rem 1rem',\n    paddingRight: '1.3rem',\n    textAlign: 'center',\n    margin: 'auto 0',\n  },\n  icon: {\n    height: '2rem',\n    width: '2rem',\n    '& span': {\n      '& svg': {\n        fontSize: '2rem',\n        borderRadius: '50%',\n        color: 'var(--grey-unselect)',\n      },\n      '& svg:hover': {\n        color: 'var(--blue-highlight)',\n        cursor: 'pointer',\n      }\n    },\n  }\n}));\n","import React from 'react'\nimport LayersPopper from './LayersPopper'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { useRecoilState} from 'recoil'\nimport { filterAttributes } from 'data/recoil'\n\nexport default function FilterBar() {\n  const classes = useStyles()\n\n  return (\n    <div className={classes.filterBarRoot}>\n      <div className={classes.logo}/>\n      <div className={classes.filters}>\n        <FilterOption name=\"Model\" control=\"dropdown\"/>\n        <FilterOption name=\"Bedrooms\" control=\"dropdown\"/>\n        <FilterOption name=\"Prices\" control=\"dropdown\"/>\n        <LayersPopper/>\n      </div>\n    </div>\n  )\n}\n\nconst FilterOption = ({name, control}) => {\n  const classes = useStyles()\n  const [filters, setFilters] = useRecoilState(filterAttributes)\n  const updateHandler = e => {\n    setFilters({\n      ...filters,\n      [e.target.name]: e.target.value.split(',')\n    })\n  }\n  return (\n    <div className={classes.filterOptionRoot}>\n      {name}\n      {control === 'dropdown' && \n        name === 'Model' \n        ? (<select name='flat_model' onChange={updateHandler}>\n          <option value=\"\">All</option>\n          <option>Improved</option>\n          <option>New Generation</option>\n          <option>Standard</option>\n          <option>Simplified</option>\n          <option>Model A</option>\n          <option>Premium Apartment</option>\n          <option>Apartment</option>\n          <option>Model A2</option>\n          <option>Adjoined flat</option>\n          <option>2-room</option>\n          <option>Terrace</option>\n          <option>DBSS</option>\n          <option>Type S2</option>\n          <option>Type S1</option>\n          <option>Premium Apartment Loft</option>\n          <option>Maisonette</option>\n          <option>Model A-Maisonette</option>\n          <option>Premium Maisonette</option>\n          <option>Improved-Maisonette</option>\n          <option>Multi Generation</option>\n        </select>) \n        : name === 'Bedrooms' \n        ? (<select name='room' onChange={updateHandler}>\n          <option value=\"\">All</option>\n          <option value=\"1 ROOM\">1 Rooms</option>\n          <option value=\"2 ROOM\">2 Rooms</option>\n          <option value=\"3 ROOM\">3 Rooms</option>\n          <option value=\"4 ROOM\">4 Rooms</option>\n          <option value=\"5 ROOM\">5 Rooms</option>\n          <option value=\"EXECUTIVE\">Executive</option>\n        </select>) \n        : name === 'Prices' \n        && (<select name='resale_price' onChange={updateHandler}>\n          <option value={[0, Infinity]}>All</option>\n          <option value={[150000, 250000]}>150K to 250K</option>\n          <option value={[250000, 500000]}>250K to 500K</option>\n          <option value={[500000, Infinity]}>More than 500K</option>\n        </select>) \n      }\n    </div>\n  )\n}\n\nconst useStyles = makeStyles(() => ({\n  filterBarRoot: {\n    display: 'grid',\n    fontSize: '0.85rem',\n    gridTemplateColumns: 'minmax(150px, 10%) 1fr auto',\n  },\n  logo: {\n    width: '100px',\n    height: '2rem',\n    margin: '1rem',\n    backgroundColor: 'white',\n  },\n  filters: {\n    height: 'auto',\n    display: 'grid',\n    gridTemplateColumns: 'repeat(3, 1fr) minmax(2rem,5%)',\n  },\n  filterOptionRoot: {\n    display: 'flex',\n    flexDirection: 'column',\n    padding: '0.5rem 1rem',\n    borderTop: '5px var(--dark-background) solid',\n    color: 'var(--grey-unselect)',\n    fontWeight: '600',\n    fontSize: '0.85rem',\n    letterSpacing: '0.025rem',\n    transition: 'all 0.35s',\n    '&:hover, &:active': {\n      borderTop: '5px var(--blue-highlight) solid',\n    },\n    '& select': {\n      marginTop: '0.5rem',\n      border: 'none',\n      borderRadius: '0.2rem',\n      borderStyle: 'none',\n      fontSize: '0.9rem',\n      letterSpacing: '0.025rem',\n      backgroundColor: 'transparent',\n      color: 'var(--blue-highlight)',\n      fontWeight: '600',\n      outlineColor: 'transparent',\n      transition: 'all ease-in-out 0.15s',\n      '&:focus, &:active': {\n        outline: 'none',\n        border: 'none',\n      }\n    }\n  },\n}))\n","import { withStyles } from '@material-ui/core/styles';\nimport Slider from '@material-ui/core/Slider';\n\nconst iOSBoxShadow =\n  '0 3px 1px rgba(0,0,0,0.1),0 4px 8px rgba(0,0,0,0.13),0 0 0 1px rgba(0,0,0,0.02)';\n\nconst IOSSlider = withStyles({\n  root: {\n    color: '#3880ff',\n    height: 2,\n    padding: '15px 0',\n    marginLeft: 12,\n    width: '95%',\n  },\n  thumb: {\n    height: 28,\n    width: 28,\n    backgroundColor: '#fff',\n    boxShadow: iOSBoxShadow,\n    marginTop: -14,\n    marginLeft: -14,\n    '&:focus, &:hover, &$active': {\n      boxShadow: '0 3px 1px rgba(0,0,0,0.1),0 4px 8px rgba(0,0,0,0.3),0 0 0 1px rgba(0,0,0,0.02)',\n      // Reset on touch devices, it doesn't add specificity\n      '@media (hover: none)': {\n        boxShadow: iOSBoxShadow,\n      },\n    },\n  },\n  active: {},\n  valueLabel: {\n    left: 'calc(-50% + 12px)',\n    top: -15,\n    '& *': {\n      background: 'transparent',\n      color: '#000',\n    },\n  },\n  track: {\n    height: 1,\n  },\n  rail: {\n    height: 2,\n    opacity: 0.5,\n    backgroundColor: '#bfbfbf',\n  },\n  mark: {\n    backgroundColor: '#bfbfbf',\n    height: 20,\n    width: 2,\n    marginTop: -10,\n  },\n  markActive: {\n    opacity: 1,\n    backgroundColor: 'currentColor',\n  },\n})(Slider);\n\nexport default IOSSlider;","// /* global requestAnimationFrame, cancelAnimationFrame */\nimport React, {useEffect, useState} from 'react';\nimport PropTypes from 'prop-types';\nimport { makeStyles } from '@material-ui/core/styles';\nimport IOSSlider from 'components/Slider';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Button from '@material-ui/core/IconButton';\nimport { MdPlayArrow, MdPause } from \"react-icons/md\";\nimport { useSetRecoilState } from 'recoil';\nimport { UITxtLoading } from 'data/recoil';\n\nexport default function Timeline({min, max, value, onChange}) {\n  const setTxtLoading = useSetRecoilState(UITxtLoading)\n  setTxtLoading(\"Loading Timeline...\")\n  const classes = useStyles();\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [animation] = useState({});\n\n  const MS_PER_DAY = 8.64e7;\n  const ANIMATION_SPEED = 30;\n  \n  // prettier-ignore\n  useEffect(() => {\n    return () => animation.id && cancelAnimationFrame(animation.id);\n  }, [animation]);\n\n  if (isPlaying && !animation.id) {\n    const span = value[1] - value[0];\n    let nextValueMin = value[0] + (MS_PER_DAY * ANIMATION_SPEED);\n    if (nextValueMin + span >= max) {\n      nextValueMin = min;\n    }\n    animation.id = requestAnimationFrame(() => {\n      animation.id = 0;\n      onChange([nextValueMin, nextValueMin + span]);\n    });\n  }\n\n  const isButtonEnabled = value[0] > min || value[1] < max;\n\n  return (\n    <div className={classes.root}>\n      <Button variant=\"outlined\"  disabled={!isButtonEnabled} onClick={() => setIsPlaying(!isPlaying)}>\n        {isPlaying ? <MdPause title=\"Stop\" /> : <MdPlayArrow title=\"Animate\" />}\n      </Button>\n      <IOSSlider\n        getAriaValueText={valuetext}\n        aria-labelledby=\"ios slider\"\n        className={classes.timeline}\n        // marks={marks}\n        // step={1/12}\n        min={min}\n        max={max}\n        value={value}\n        onChange={(event, newValue) => onChange(newValue)}\n        valueLabelDisplay=\"auto\"\n        valueLabelFormat={formatLabel}\n      />\n    </div>\n  )\n}\n\nexport const getTooltip = ({object}) => {\n  return (\n    object &&\n    `\\\n    Time: ${new Date(object.timestamp).toUTCString()}\n    Magnitude: ${object.magnitude}\n    Depth: ${object.depth}\n    `\n  );\n}\n\nconst useStyles = makeStyles(() => ({\n  root: {\n    width: '100%',\n    height: '4rem',\n    backgroundColor: 'white',\n    color: 'var(--dark-background)',\n    display: 'grid',\n    gridTemplateColumns: 'minmax(50px, 5%) auto',\n    textAlign: 'center',\n    borderTop: '1px var(--grey-border) solid',\n    overflow: 'auto',\n    overflowY: 'hidden',\n    '&>*': {\n      margin: 'auto 0',\n    }, \n    '& button': {\n      position: 'sticky',\n      left: '1rem',\n      zIndex: 3,\n      border: '0.1rem solid var(--dark-highlight)',\n      borderRadius: '50%',\n      height: '2.5rem',\n      width: '2.5rem',\n      margin: '0.5rem 1.5rem',\n      color: 'var(--dark-highlight)',\n      fontSize: '10rem',\n      padding: '0.3rem'\n    },\n    '& button:hover': {\n      color: 'var(--blue-highlight)',\n    },\n    '& button::after': {\n      content: 'close-quote',\n      width: '200%',\n      height: '200%',\n      position: 'absolute',\n      zIndex: -1,\n      backgroundColor: 'white',\n    },\n    '& button::before': {\n      content: 'close-quote',\n      position: 'absolute',\n      borderRadius: '50%',\n      height: '2.4rem',\n      width: '2.4rem',\n      border: '0.1rem solid var(--dark-highlight)',\n    },\n    '& button:hover::before': {\n      border: '0.1rem solid var(--blue-highlight)',\n    },\n    '& button:disabled::before': {\n      border: '0.1rem solid rgba(0, 0, 0, 0.26)',\n    },\n  },\n  timeline: {\n    zIndex: 2,\n    margin: 'auto 1rem',\n  }\n}));\n\n\nfunction ValueLabelComponent(props) {\n  const { children, open, value } = props;\n\n  return (\n    <Tooltip open={open} enterTouchDelay={0} placement=\"top\" title={value}>\n      {children}\n    </Tooltip>\n  );\n}\n\nValueLabelComponent.propTypes = {\n  children: PropTypes.element.isRequired,\n  open: PropTypes.bool.isRequired,\n  value: PropTypes.number.isRequired,\n};\n\nfunction valuetext(value) {\n  return `${value}`;\n}\n\nfunction formatLabel(t) {\n  const date = new Date(t);\n  return `${date.getUTCFullYear()}/${date.getUTCMonth() + 1}`;\n}\n\nexport function getTimeRange(data) {\n  if (!data) {\n    return null;\n  }\n  // console.log(data)\n  return data?.reduce(\n    (range, d) => {\n      const t = d.timestamp;\n      range[0] = Math.min(range[0], t);\n      range[1] = Math.max(range[1], t);\n      return range;\n    },\n    [Infinity, -Infinity]\n  );\n}","import React from 'react'\nimport { FiMap, FiBarChart2, FiChevronUp, FiMenu, FiBookmark, FiSettings } from \"react-icons/fi\";\nimport { makeStyles } from '@material-ui/core/styles'\n\nexport default function TabBar() {\n  const classes = useStyles();\n\n  return (\n    <div className={classes.root}>\n      <button className={classes.item}> <FiMap/> Map </button>\n      <button className={classes.item}> <FiBarChart2/> Charts </button>\n\n      <button className={classes.pull}>\n        <FiChevronUp />\n        <br />\n        <FiMenu />\n      </button>\n\n      <button className={classes.item}> <FiBookmark/> Highlights </button>\n      <button className={classes.item}> <FiSettings /> Settings </button>\n    </div>\n  )\n}\n\nconst useStyles = makeStyles(() => ({\n  root: {\n    display: 'flex',\n    height: '3.8rem',\n    backgroundColor: 'white',\n  },\n  item: {\n    flex: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center',\n    justifyContent: 'center',\n    fontSize: '0.8rem',\n    border: 'none',\n    backgroundColor: 'white',\n    '& svg': {\n      fontSize: '1.5rem',\n      margin: '0.5rem 0.1rem',\n    }\n  },\n  pull: {\n    flex: 0.5,\n    position: 'relative',\n    bottom: '2rem',\n    border: 'none',\n    borderRadius: '15px',\n    backgroundColor: 'white',\n    boxShadow: '6px 10px 35px 0px rgba(225,225,225,0.5)',\n    '& svg:nth-child(3)': {\n      fontSize: '1.2rem',\n    }\n  }\n}));\n","import React from 'react'\nimport Drawer from '@material-ui/core/Drawer'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { useRecoilState, useRecoilValue } from 'recoil'\nimport { layerSelection } from 'data/recoil'\nimport { selectedGeojsonArea } from 'data/recoil'\n\nexport default function TabDrawer({\n  state,\n  width, \n  anchor,\n  triggerTagLocation,\n  triggerName,\n  triggerHeight, \n  triggerWidth,\n  styleSeparator,\n  styleTrigger,\n  children\n}) {\n  const layerSelected = useRecoilValue(layerSelection)\n  const selectedArea = useRecoilValue(selectedGeojsonArea)\n  const fullHeight = layerSelected !== 'hex' && !selectedArea\n\n  const useStyles = makeStyles(() => ({\n    drawer: {\n      width: width,\n      marginTop: '2rem',\n      flexShrink: 0,\n      zIndex: 1,\n      color: 'white'\n    },\n    drawerPaper: {\n      top: '4rem',\n      width: width,\n      height: `calc(100% - 8rem ${fullHeight ? '- 2rem': '+ 2rem'})`,\n      overflowY: 'visible',\n      background: 'var(--dark-background)',\n      padding: '1rem',\n      color: 'white',\n    },\n    drawerContainer: {\n      overflow: 'visible',\n      height: '100%',\n    },\n    separator: {\n      width: '100%',\n      height: '0.3rem',\n      background: 'var(--blue-highlight)',\n      display:'block',\n      zIndex: 10,\n      marginTop: '-1rem',\n      marginLeft: '-1rem',\n      ...styleSeparator\n    },\n    drawerTrigger: {\n      position: 'relative',\n      transformOrigin: 'right',\n      transform: 'rotate(270deg)',\n      right: `calc(100% - ${triggerWidth} + ${triggerHeight})`,\n      top: 'calc(-1.5rem)',\n      height: triggerHeight,\n      width: triggerWidth,\n      cursor: 'pointer',\n      userSelect: 'none',\n      visibility: 'visible',\n      background: 'var(--dark-highlight)',\n      color: 'white',\n      textAlign: 'center',\n      borderRadius: '0.3rem 0.3rem 0 0',\n      ...styleTrigger\n    }\n  }))\n  const [open, setOpen] = useRecoilState(state);\n  const toggleDrawerOpen = () => setOpen(!open)\n  const classes = useStyles()\n\n  return (\n    <>\n      <Drawer\n        className={classes.drawer}\n        variant='persistent'\n        open={open}\n        classes={{\n          paper: classes.drawerPaper,\n        }}\n        anchor={anchor}\n      >\n        <div className={classes.drawerContainer}>\n          <span className={classes.separator}></span>\n          <div \n            onClick={toggleDrawerOpen}\n            className={classes.drawerTrigger}\n          >\n            {triggerTagLocation === 'start' && `[${open ? 'Hide': 'Show'}] ` }\n            {triggerName} \n            {triggerTagLocation === 'end' && `[${open ? 'Hide': 'Show'}]` }\n          </div>\n          {children}\n        </div>\n      </Drawer>\n    </>\n  )\n}\n\n","import React from 'react'\nimport { makeStyles } from '@material-ui/core/styles'\nimport TabDrawer from 'components/TabDrawer'\nimport { useRecoilValue } from 'recoil'\nimport { \n  mapData,\n  UIdrawerDataPointOpen \n} from 'data/recoil'\n\nexport default function DrawerDataPoint() {\n  const classes = useStyles()\n  const data = useRecoilValue(mapData)\n  \n  return (\n    <>\n      <TabDrawer\n        state={UIdrawerDataPointOpen}\n        width='20vw'\n        triggerTagLocation='start'\n        triggerName='Data Points'\n        triggerHeight= '2rem'\n        triggerWidth='50%'\n        styleSeparator={style.separator}\n        styleTrigger={style.trigger}\n      >\n        <SortBar/>\n        <div className={classes.dataCardContainer}>\n          {data.slice(0,50).map((d,i) => <DataCard key={`datapoint-${i}`} data={d}/>)}\n        </div>\n      </TabDrawer>\n    </>\n  )\n}\n\nconst DataCard = ({data}) => {\n  const classes = useStyles()\n  \n  return (\n    <div className={classes.dataCard}>\n      <p className=\"txt-title\">{data.address}</p>\n      <small className=\"txt-subtitle\">{data.room}</small>\n      <p><small className=\"txt-highlight\">S${data.resale_price.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\")}</small></p>\n      <div className=\"txt-details-container\">\n        <span><small>{data.flat_model} Model</small></span>\n        <span className=\"dot\">·</span>\n        <span><small>{data.floor_area_sqm} sqm</small></span>\n        <span className=\"dot\">·</span>\n        <span><small>{data.lRemain} remaining </small></span>\n      </div>\n    </div>\n  )\n}\n\nconst SortBar = () => {\n  const classes = useStyles()\n  return (\n    <div className={classes.sortBar}>\n      <p className='sortBar__title'>SORT BY</p>\n      <div className='sortBar__option'>\n        A to Z\n        <span className={classes.arrow}>&#62;</span>\n      </div>\n    </div>\n  )\n}\n\nconst style = {\n  trigger: {\n    transform: 'rotate(90deg)',\n    right: '-12.5rem',\n    top: 'calc(10rem)', //TODO: find heuristic calc\n    marginTop: '-1rem',\n  },\n  separator: {\n    width: 'calc(100% + 2rem)',\n  }\n}\n\nconst useStyles = makeStyles(() => ({\n  sortBar: {\n    marginTop: '-1rem',\n    '& .sortBar__title': {\n      fontSize: '12.8px',\n      fontSpacing: '0.75px',\n      display: 'block',\n      paddingBottom: '10px',\n      fontWeight: '700',\n    },\n    '& .sortBar__option': {\n      marginTop: '-0.5rem',\n      marginBottom: '1rem',\n      border: '2px solid var(--blue-highlight)',\n      borderRadius: '5px',\n      padding: '10px 0 10px 10px',\n      cursor: 'not-allowed !important',\n      overflowY: 'hidden' \n    },\n  },\n  arrow: {\n    height: '3rem',\n    width: '2.75rem',\n    position: 'absolute',\n    right: '1.1rem',\n    marginTop: '-0.9rem',\n    textAlign: 'center',\n    verticalAlign: 'middle',\n    lineHeight: '3rem', \n    padding: 0,\n    transform: 'rotate(90deg)',\n    backgroundColor: 'var(--blue-highlight)',\n    borderRadius: '5px 5px 0 0',\n    content: ' > ',\n  },\n  dataCardContainer: {\n    height: '90%',\n    overflowY: 'scroll',\n    marginRight: '-0.2rem',\n    paddingRight: '0.3rem'\n  },\n  dataCard: {\n    width: 'calc(100% - 1rem)',\n    height: '10vh',\n    overflow: 'hidden',\n    background: 'white',\n    borderRadius: '5px',\n    color: 'var(--black-txt)',\n    padding: '0.5rem',\n    marginBottom: '0.5rem',\n    '& p, & small': {\n      margin: '0.2rem 0'\n    },\n    '& .txt-title': {\n      fontSize: '0.8rem',\n      fontWeight: 800,\n    },\n    '& .txt-subtitle': {\n      fontWeight: 700,\n    },\n    '& .txt-highlight': {\n      fontStyle: 'italic',\n      color: 'var(--blue-highlight)',\n      fontWeight: 500,\n    },\n    '& .txt-details-container': {\n      fontSize: '0.7rem',\n      marginTop: '0.3rem'\n    },\n    '& .dot': {\n      fontSize: '1rem',\n      lineHeight: '0.1rem',\n      margin: '0 0.35rem'\n    },\n  }\n}))","import React from 'react'\nimport TabDrawer from 'components/TabDrawer'\nimport { UIdrawerStatOpen } from 'data/recoil'\nimport { selectedGeojsonArea } from 'data/recoil'\nimport { useRecoilValue } from 'recoil'\nimport { makeStyles } from '@material-ui/core'\nimport { mapData } from 'data/recoil'\nimport { Line } from \"react-chartjs-2\"\nimport _ from \"lodash\"\n\nexport default function DrawerStatistics() {\n  const classes = useStyles()\n  const selectedArea = useRecoilValue(selectedGeojsonArea)\n  const data = useRecoilValue(mapData)\n  \n  // get room count\n  const count = {}\n  // eslint-disable-next-line\n  Array(\"1 ROOM\", \"2 ROOM\", \"3 ROOM\", \"4 ROOM\", \"5 ROOM\", \"EXECUTIVE\").map(r => count[r] = 0)\n  data.map(d => count[d.room] += 1)\n\n  //get tri-yearly growth\n  const growth = {}\n  _.range(1990, 2023, 3).map(y => growth[y] = 0)\n  _.range(1990, 2023, 3).map(y => \n    data\n      .filter(d => d.town === selectedArea?.PLN_AREA_N)\n      .filter(d => new Date(d.timestamp).getFullYear() === y)\n      .map(d => growth[y] += d.resale_price)\n  )\n  _.range(1990, 2023, 3).map(y => growth[y] /= data.length)\n\n  const dashboardActiveCountriesCard = {\n    data: canvas => {\n      var ctx = canvas.getContext(\"2d\");\n      var gradientStroke = ctx.createLinearGradient(500, 0, 100, 0);\n      gradientStroke.addColorStop(0, \"#2CA8FF\");\n      gradientStroke.addColorStop(1, chartColor);\n      var gradientFill = ctx.createLinearGradient(0, 170, 0, 50);\n      gradientFill.addColorStop(0, \"rgba(128, 182, 244, 0)\");\n      gradientFill.addColorStop(1, hexToRGB(\"#2CA8FF\", 0.4));\n  \n      return {\n        labels: Object.keys(growth),\n        datasets: [\n          {\n            label: \"Every 3 Years (1990 - 2020)\",\n            backgroundColor: gradientFill,\n            borderColor: \"#2CA8FF\",\n            pointBorderColor: \"#FFF\",\n            pointBackgroundColor: \"#2CA8FF\",\n            pointBorderWidth: 2,\n            pointHoverRadius: 4,\n            pointHoverBorderWidth: 1,\n            pointRadius: 4,\n            fill: true,\n            borderWidth: 2,\n            data: Object.keys(growth).length > 0\n              ? Object.values(growth)\n              : Array(2020 - 1990).fill(0)\n          }\n        ]\n      };\n    },\n    options: gradientChartOptionsConfiguration\n  };\n    \n  return (\n    <>\n      <TabDrawer\n        state={UIdrawerStatOpen}\n        width='25vw'\n        anchor='right'\n        triggerTagLocation='end'\n        triggerName='Area Statistics '\n        triggerHeight='2rem'\n        triggerWidth='50%'\n        styleSeparator={style.separator}\n      >\n        <div className={classes.statDrawerContainer}>\n          <h1 className={classes.areaTitle}>{selectedArea?.PLN_AREA_N}</h1>\n          <div className={classes.detailsContainer}>\n            <div>\n              <small>REGION</small>\n              <strong><p>{selectedArea?.REGION_N.replace(/\\w+[.!?]?$/, '')}</p></strong>\n            </div>\n            <div>\n              <small>AREA</small>\n              <p style={{marginTop: '0.3rem'}}>\n                <strong>{(parseInt(selectedArea?.SHAPE_Area) / 1000000).toFixed(2)}</strong>KM\n                <sup>2</sup>\n              </p>\n            </div>\n            {/* <div>\n              <small>PRICE RANK</small>\n              <p><strong>0</strong>/52</p>\n            </div> */}\n          </div>\n          {data.length > 0 \n          ? <>\n              <div className={classes.graphContainer}>\n                <small>AVERAGE RESALE PRICE GROWTH</small>\n                <Line\n                  data={dashboardActiveCountriesCard.data}\n                  options={dashboardActiveCountriesCard.options}\n                  id=\"chart-points\"\n                />\n              </div>\n              <div className={classes.lineChartContainer}>\n                <h2>Top Resale Units Types</h2>\n                {Object\n                  .entries(count)\n                  .filter(c => c[1] > 0)\n                  .map(room => {\n                    return (\n                      <div className={classes.lineChartCont} key={`${room[0]}-${room[1]}`}>\n                        <p className=\"\">{`${room[0]}` }</p>\n                        <div className={classes.lineChart}>\n                          <div style={{width: `calc(${(room[1] / data.length * 100).toFixed(0)}% - 2rem`}}>{room[1]} Units</div>\n                        </div>\n                      </div>\n                    )\n                  })\n                }\n              </div>\n            </>\n            : <center><p>This area has no HDB Resale Unit <br/>for current filter selections.</p></center>\n          }\n        </div>\n      </TabDrawer>\n    </>\n  )\n}\n\nconst chartColor = \"#001529\";\nconst hexToRGB = (hex, alpha) => {\n  var r = parseInt(hex.slice(1, 3), 16),\n    g = parseInt(hex.slice(3, 5), 16),\n    b = parseInt(hex.slice(5, 7), 16);\n\n  if (alpha) {\n    return \"rgba(\" + r + \", \" + g + \", \" + b + \", \" + alpha + \")\";\n  } else {\n    return \"rgb(\" + r + \", \" + g + \", \" + b + \")\";\n  }\n}\n\nconst gradientChartOptionsConfiguration = {\n  maintainAspectRatio: false,\n  legend: {\n    display: false\n  },\n  tooltips: {\n    bodySpacing: 4,\n    mode: \"nearest\",\n    intersect: 0,\n    position: \"nearest\",\n    xPadding: 10,\n    yPadding: 10,\n    caretPadding: 10\n  },\n  responsive: 1,\n  scales: {\n    yAxes: [\n      {\n        display: 0,\n        ticks: {\n          display: false,\n          maxTicksLimit: 5\n        },\n        gridLines: {\n          zeroLineColor: \"transparent\",\n          drawTicks: false,\n          display: false,\n          drawBorder: false\n        }\n      }\n    ],\n    xAxes: [\n      {\n        display: 0,\n        ticks: {\n          display: false\n        },\n        gridLines: {\n          zeroLineColor: \"transparent\",\n          drawTicks: false,\n          display: false,\n          drawBorder: false\n        }\n      }\n    ]\n  },\n  layout: {\n    padding: { left: 0, right: 0, top: 15, bottom: 15 }\n  }\n};\n\nconst style = {\n  separator: {\n    width: 'calc(100% + 2rem)',\n    marginRight: '-1rem',\n  }\n}\n\nconst useStyles = makeStyles(() => ({\n  statDrawerContainer: {\n    height: '99%',\n    overflowY: 'scroll',\n    marginTop: '-1rem'\n  },\n  areaTitle: {\n    marginTop: 0,\n    fontSize: '1.7rem',\n    fontWeight: 600,\n  },\n  detailsContainer: {\n    display: 'flex',\n    textAlign: 'center',\n    justifyContent: 'space-around',\n    '& p': {\n      fontSize: '1.2rem',\n      marginTop: '0.6rem'\n    },\n  },\n  graphContainer: {\n    textAlign: 'center',\n    height: '20rem',\n    color: 'white',\n  },\n  lineChartContainer: {\n    '& h2': {\n      fontSize: '1.4rem',\n      fontWeight: 400,\n    },\n  },\n  lineChartCont: {\n    marginBottom: '1rem',\n    '& p': {\n      marginBottom: '0.5rem',\n      fontSize: '0.8rem'\n    }\n  },\n  lineChart: {\n    width: '100%', \n    height: '1rem',\n    background: 'white',\n    borderRadius: '1rem',\n    '& div': {\n      background: 'var(--blue-icon-select)', \n      height: '1rem',\n      borderRadius: '1rem',\n      color: 'black',\n      fontSize: '0.8rem',\n      padding: '0 1rem',\n      overflow: 'hidden',\n    }\n  }\n}))\n","import React, { useState, useMemo } from 'react';\nimport MapboxGLMap from 'layouts/common/Map'\nimport FilterPills from 'layouts/mobile/FilterPills'\nimport FilterBar from 'layouts/desktop/FilterBar';\nimport Timeline, { getTimeRange } from 'layouts/desktop/Timeline'\nimport TabBar from 'layouts/mobile/TabBar';\nimport DrawerDataPoint from 'layouts/desktop/DrawerDataPoint';\nimport DrawerStatistics from 'layouts/desktop/DrawerStatistics';\nimport { useMediaQuery } from 'react-responsive'\nimport { makeStyles } from '@material-ui/core/styles';\nimport { useSetRecoilState, useRecoilValue } from 'recoil';\nimport { mapOriginalData, UITxtLoading } from 'data/recoil';\nimport { modalControls, layerSelection } from 'data/recoil';\nimport { selectedGeojsonArea } from 'data/recoil';\n\n\nexport default function App() {\n  const setTxtLoading = useSetRecoilState(UITxtLoading)\n  setTxtLoading(\"Loading Application...\")\n  const classes = useStyles()\n  const isMobile = useMediaQuery({ maxWidth: 767, orientation: \"portrait\"})\n  const data = useRecoilValue(mapOriginalData)\n  const modal = useRecoilValue(modalControls)\n  const layerSelected = useRecoilValue(layerSelection);\n  const selectedArea = useRecoilValue(selectedGeojsonArea);\n\n  const [filter, setFilter] = useState(null)\n\n  const timeRange = useMemo(() =>  getTimeRange(data), [data]);\n  const filterValue = filter || timeRange;\n\n  return (\n    <>\n      {data && (\n        <div className={classes.App}>\n          { !isMobile && <>\n            <div className=\"section header\"> <FilterBar /> </div>\n            <DrawerDataPoint/>\n            {modal.layers.checkbox['Region Border Layer (2D Only)'] && \n              selectedArea &&\n              <DrawerStatistics/>\n            }\n            </>\n          }\n          <main className=\"content\">\n            <MapboxGLMap filterValue={filterValue}/>\n            {isMobile && <FilterPills/>}\n          </main>\n          {layerSelected !== 'hex' && !selectedArea &&\n            <footer className=\"footer\" >\n              { isMobile ? <TabBar/> : (timeRange && \n                <Timeline \n                  min={timeRange[0]}\n                  max={timeRange[1]}\n                  value={filterValue}\n                  onChange={setFilter}\n                />\n              )}\n            </footer>\n          }\n        </div>\n      )}\n    </>\n  );\n}\n\nconst useStyles = makeStyles(() => ({\n  App: {\n    display: 'flex',\n    flexDirection: 'column',\n    width: '100%',\n    height: '100%',\n    '& .section': { fontSize: '1rem' },\n    '& .header, & .footer': {\n      flex: '1',\n      height: '100%',\n      width: '100%',\n      background: 'var(--dark-background)',\n      zIndex: 2,\n    },\n    '& .footer': { zIndex: 2, },\n    '& .content': { flex: 20, },\n  }\n}));","import React from 'react';\nimport Backdrop from '@material-ui/core/Backdrop';\n// import CircularProgress from '@material-ui/core/CircularProgress';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { useRecoilValue } from 'recoil';\nimport { UITxtLoading } from 'data/recoil';\n\nconst useStyles = makeStyles((theme) => ({\n  backdrop: {\n    zIndex: theme.zIndex.drawer + 1,\n    color: 'var(--blue-highlight)',\n    background: 'white'\n  },\n}));\n\nexport default function BackDrop({open}) {\n  const txtLoading = useRecoilValue(UITxtLoading)\n  const classes = useStyles();\n\n  return (\n    <div>\n      <Backdrop className={classes.backdrop} open={open}>\n        {/* <CircularProgress color=\"inherit\" /> */}\n        <h1>{txtLoading}</h1>\n        {/* {console.log(txtLoading)} */}\n      </Backdrop>\n    </div>\n  );\n}\n","import React from 'react'\nimport App from \"./App\"\nimport BackDrop from 'components/BackDrop'\n\n// Data \nimport * as d3 from 'd3-fetch'\n// import resales from 'data/resale1990_2020onwards.csv'\n// import borders from 'data/borders.geojson'\nimport { useSetRecoilState, useRecoilValue } from 'recoil';\nimport { mapOriginalData, mapData, borderData, UILoading, UITxtLoading } from 'data/recoil'\n\nexport default function InitApp() {\n  const loading = useRecoilValue(UILoading)\n  const setTxtLoading = useSetRecoilState(UITxtLoading)\n  const setOriginal = useSetRecoilState(mapOriginalData)\n  const setMapData = useSetRecoilState(mapData)\n  const setBorder = useSetRecoilState(borderData)\n\n  d3.csv(`https://raw.githubusercontent.com/keanecodes/fyp/main/src/data/resale1990_2020onwards.csv?token=${process.env.REACT_APP_RESALE_CSV_ACCESS_TOKEN}`).then(res => {\n    if (res) {\n      const data = res.map(row => ({\n        address: String(`${row.block} ${row.street_name}`),\n        room: String(row.flat_type),\n        flat_model: String(row.flat_model),\n        lRemain: String(row.remaining_lease),\n        \n        town: String(row.town),\n\n        timestamp: new Date(`${row.month}`).getTime(),\n        latitude: Number(row.latitude),\n        longitude: Number(row.longitude),\n        resale_price: Number(row.resale_price),\n        floor_area_sqm: Number(row.floor_area_sqm)\n      }));\n      setTxtLoading(\"Loading 100,000 Data Points...\")\n      \n      setMapData(data)\n      setOriginal(data)\n\n      d3.json(`https://raw.githubusercontent.com/keanecodes/fyp/main/src/data/borders.geojson?token=${process.env.REACT_APP_BORDER_GEOJSON_ACCESS_TOKEN}`).then(data => {\n        setBorder(data)\n        setTxtLoading(\"90%\")\n      });\n    }\n  })\n\n  return (\n    <>\n      {loading && <BackDrop open={true}/>}\n      <App/>\n    </>\n  )\n}\n","// Framework\nimport React from 'react';\n\n//Routing\nimport { render } from 'react-dom';\nimport { Router, Route, Switch, Redirect } from \"react-router-dom\";\nimport { createBrowserHistory } from \"history\";\nimport { RecoilRoot } from 'recoil'\n\nimport InitApp from 'pages/InitApp'\nimport './index.css';\n\nconst hist = createBrowserHistory();\n      \nrender(\n  // <React.StrictMode>\n    <RecoilRoot>\n      <Router history={hist}>\n        <Switch>\n          <Route\n            path=\"/\"\n            render={props => {\n              return <InitApp {...props}/>;\n            }}\n          />\n          <Route render={() => <Redirect to=\"/\" />} />\n        </Switch>\n      </Router>\n    </RecoilRoot> \n  // </React.StrictMode>,\n  ,document.getElementById('root')\n);\n\n\n"],"sourceRoot":""}